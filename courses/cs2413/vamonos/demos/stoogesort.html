<html><head>
    <title>Stooge Sort</title>

    <meta id="meta" name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="../lib/vamonos.css">
    <link rel="stylesheet" href="../lib/vamonos-demos.css">
    <script type="text/javascript" src="../lib/vamonos-all.js"></script>

    <link rel="stylesheet" href="../deps/bootstrap.min.css">
    <link rel="stylesheet" href="../deps/bootstrap-theme.min.css">
    <script type="text/javascript" src="../deps/bootstrap.min.js"></script>

    <style type="text/css">

        td.gt-r, td.lt-l {
            background-color: #999 !important;
        }

        body {
            text-align: center;
        }
    </style>

</head>
<body>

    <br>
    <div class="container">
        <div class="row nopadding">
            <div class="panel vamonos col-sm-6 col-sm-offset-3 col-md-offset-3 col-md-5 col-lg-offset-4 col-lg-4 panel-default">
                <div class="panel-heading">
                    Stooge Sort
                </div>
                <div id="controls"> </div>
                <div class="pseudocode-procedures">
                    <div id="stoogeSort" title="StoogeSort(A,l,r):">
                        if A[r] &lt; A[l]
                        swap A[r] and A[l]
                        if r - l &gt; 1
                        t = floor((r - l + 1)/3)
                        StoogeSort(A,l,r-t)
                        StoogeSort(A,l+t,r)
                        StoogeSort(A,l,r-t)
                    </div>
                </div>
                <table class="variable-widgets">
                    <tr><td><div id="array-a-var"></div></td>
                        <td><div id="array-a"></div></td></tr>
                    <tr><td><div id="callstack-var"></div></td>
                        <td><div id="callstack"></div></td></tr>
                </table>
            </div>
        </div>
    </div>

</body>
<script type="text/javascript">

var qs = new Vamonos.Visualizer({
    widgets: [

        new Vamonos.Widget.Controls({
            container: "controls"
        }),

        new Vamonos.Widget.Pseudocode({
            container: "stoogeSort",
            procedureName: "stoogeSort",
        }),

        new Vamonos.Widget.VarName({
            container: "callstack-var",
            varName: "_callstack",
            displayName: "Call Stack",
        }),

        new Vamonos.Widget.CallStack({
            container: "callstack",
            procedureNames: {
                stoogeSort: "StoogeSort",
            },
            ignoreMain: true,
            ignoreArgumentValues: ["A"],
        }),

        new Vamonos.Widget.VarName({
            container: "array-a-var",
            varName: "A",
            watching:true,
        }),

        new Vamonos.Widget.Array({
            container: "array-a",
            varName: "A",
            defaultInput: [0,2,8,7,1,3,5,6,4],
            ignoreIndexZero: true,
            showIndices: ["l","r"],
            cssRules: [
                ['<', 'l', 'lt-l'],
                ['>', 'r', 'gt-r'],
            ],
        }),

    ],

    maxCallStackSnapshotDepth: 4,

    algorithm: {
        main: function(_){
            with(this){
                stoogeSort({ A:A, l:1, r:A.length })
            }
        },

        stoogeSort: function(_){
            // q needs to be localized somehow otherwise
            // recursions will overwrite it
            with(this){
                if (_(1), A[r] < A[l]) {
                    var temp = A[r];
                    A[r] = A[l];
                    A[l] = temp;
                }
                if (r - l > 1) {
                    _(4);
                    t = Math.floor( (r-l+1)/ 3 );
                    var tSave = t;
                    _(5);
                    stoogeSort({ A:A, l:l, r:(r-t) });
                    t = tSave;
                    _(6);
                    stoogeSort({ A:A, l:(l+t), r:r});
                    t = tSave;
                    _(7);
                    stoogeSort({ A:A, l:l, r:(r-t) });
                }
            }
        },
    }

});

</script>
</html>
