<html><head>
    <title>Quicksort</title>

    <meta id="meta" name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="../lib/vamonos.css">
    <link rel="stylesheet" href="../lib/vamonos-demos.css">
    <script type="text/javascript" src="../lib/vamonos-all.js"></script>

    <link rel="stylesheet" href="../deps/bootstrap.min.css">
    <link rel="stylesheet" href="../deps/bootstrap-theme.min.css">
    <script type="text/javascript" src="../deps/bootstrap.min.js"></script>

    <style type="text/css">

        td.gt-i.leq-j {
            background-color: white !important;
        }

        td.gt-r, td.lt-p {
            background-color: #999 !important;
        }

        body {
            text-align: center;
        }
    </style>

</head>
<body>

    <br>
    <div class="container">
        <div class="row">
            <div class="col-md-offset-1 col-md-10 col-lg-offset-2 col-lg-8 panel-default">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        Quicksort
                    </div>
                    <div class="row nopadding panel-body">
                        <div class="col-sm-5 nopadding">
                            <div id="controls"> </div>
                            <div class="pseudocode-procedures">
                                <div id="quicksort" title="Quicksort(A,p,r):">
                                    if p &lt; r
                                        q = Partition(A,p,r)
                                        Quicksort(A,p,q - 1)
                                        Quicksort(A,q + 1,r)
                                </div>
                                <div id="partition" title="Partition(A,p,r):">
                                    i = p-1
                                    for j = p to r-1
                                        if A[j] &le; A[r]
                                            i = i + 1
                                            exchange A[i] with A[j]
                                    exchange A[i+1] with A[r]
                                    return i+1
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-7 nopadding">
                            <table class="variable-widgets">
                                <tr><td><div id="array-var"></div></td>
                                    <td><div id="array"></div></td></tr>

                                <tr><td><div id="callstack-var"></div></td>
                                    <td><div id="callstack"></div></td></tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
<script type="text/javascript">

var qs = new Vamonos.Visualizer({
    widgets: [

        new Vamonos.Widget.Controls({
            container: "controls"
        }),

        new Vamonos.Widget.Pseudocode({
            container: "quicksort",
            procedureName: "quicksort"
        }),

        new Vamonos.Widget.Pseudocode({
            container: "partition",
            procedureName: "partition",
        }),

        new Vamonos.Widget.VarName({
            container: "callstack-var",
            varName: "_callstack",
            displayName: "Call Stack",
            watching: true,
        }),

        new Vamonos.Widget.CallStack({
            container: "callstack",
            procedureNames: {
                quicksort: "Quicksort",
                partition: "Partition"
            },
            ignoreMain: true,
            ignoreArgumentValues: ["A"],
        }),

        new Vamonos.Widget.VarName({
            container: "array-var",
            varName: "A",
            watching: true
        }),

        new Vamonos.Widget.Array({
            container: "array",
            varName: "A",
            defaultInput: [0,2,8,7,1,3,5,6,4],
            ignoreIndexZero: true,
            showIndices: ["p","r","partition::j","partition::i"],
            cssRules: [
                ['>', 'i', 'gt-i'],
                ['<', 'p', 'lt-p'],
                ['<=', 'j', 'leq-j'],
                ['>','r','gt-r'],
            ],
        }),

    ],

    algorithm: {
        main: function(_){
            with(this){
                quicksort({ A:A, p:1, r:A.length-1});
            }
        },
        quicksort: function(_){
            with(this){
                _(1);   if (p < r) {
                _(2);       q = partition({ A:A, p:p, r:r });
                _(3);       quicksort({ A:A, p:p, r:q-1 });
                _(4);       quicksort({ A:A, p:q+1, r:r });
                        }
            }
        },
        partition: function(_){
            with(this){
                _(1);   i = p-1;
                _(2);   for (j=p; j<r; _(3), j++) {
                _(3);       if (A[j] < A[r]) {
                _(4);           i = i + 1;
                _(5);           var temp = A[i];
                                A[i] = A[j];
                                A[j] = temp;
                            }
                        }
                _(6);   var temp = A[i+1];
                        A[i+1] = A[r];
                        A[r] = temp;
                _(7);   return(i+1);
            }
        }
    }

});

</script>
</html>
